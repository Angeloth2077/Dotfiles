function findLargestPlayingVideo(){const videos=Array.from(document.querySelectorAll("video")).filter((video=>0!=video.readyState)).filter((video=>0==video.disablePictureInPicture)).sort(((v1,v2)=>{const v1Rect=v1.getClientRects()[0]||{width:0,height:0},v2Rect=v2.getClientRects()[0]||{width:0,height:0};return v2Rect.width*v2Rect.height-v1Rect.width*v1Rect.height}));if(0!==videos.length)return videos[0]}async function requestPictureInPicture(video){await video.requestPictureInPicture(),video.setAttribute("__pip__",!0),video.addEventListener("leavepictureinpicture",(event=>{video.removeAttribute("__pip__")}),{once:!0}),new ResizeObserver(maybeUpdatePictureInPictureVideo).observe(video)}function maybeUpdatePictureInPictureVideo(entries,observer){const observedVideo=entries[0].target;if(!document.querySelector("[__pip__]"))return void observer.unobserve(observedVideo);const video=findLargestPlayingVideo();video&&!video.hasAttribute("__pip__")&&(observer.unobserve(observedVideo),requestPictureInPicture(video))}(async()=>{const video=findLargestPlayingVideo();video&&(video.hasAttribute("__pip__")?document.exitPictureInPicture():(await requestPictureInPicture(video),chrome.runtime.sendMessage({message:"enter"})))})();