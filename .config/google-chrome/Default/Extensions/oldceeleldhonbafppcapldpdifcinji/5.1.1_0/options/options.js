/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
!function(){const e=document.getElementById("banner"),t=document.getElementById("login"),n=document.getElementById("login-options"),o=document.getElementById("logout-button"),a=document.getElementById("manage-account-button"),s=document.getElementById("login-popup-button"),i=document.getElementById("lt-options__package-badge-container"),l=document.getElementById("managed-login"),d=document.getElementById("managed-login-options"),c=document.getElementById("managed-login-button"),r=document.getElementById("managed-logout-button"),g=document.getElementById("lt-options-discount"),u=document.getElementById("toggleSynonymsSwitch"),m=document.getElementById("togglePickyModeSwitch"),p=document.getElementById("personalDictionary"),y=document.getElementById("personalDictionary-options"),E=document.getElementById("personalDictionaryList"),h=document.getElementById("personalDictionaryInput"),f=document.getElementById("addToPersonalDictionary"),v=document.getElementById("personalDictionary-options__clearAll"),b=document.getElementById("personalDictionary-options__copy"),k=document.getElementById("ignoredRules"),L=document.getElementById("ignoredRules-options"),S=document.getElementById("ignoredRulesList"),_=document.getElementById("ignoredRules-options__clearAll"),I=document.getElementById("disabledDomains"),D=document.getElementById("disabledDomains-options"),C=document.getElementById("disabledDomainsList"),B=document.getElementById("disabledDomainsInput"),M=document.getElementById("addToDisabledDomains"),A=document.getElementById("disabledDomains-options__clearAll"),T=document.getElementById("language"),w=document.getElementById("language-options"),x=document.getElementById("preferred-languages-count"),O=document.getElementById("preferred-languages"),R=document.getElementById("new-preferred-languages"),N=document.getElementById("experimental"),U=document.getElementById("experimental-options"),P=document.getElementById("serverUrl"),V=document.getElementById("serverUrlFieldset"),G=document.getElementById("serverUrl-disabled"),H=document.getElementById("serverType-cloud"),q=document.getElementById("serverType-local"),$=document.getElementById("serverType-custom"),F=document.getElementById("localServerAvailabilityWarning"),Y=document.getElementById("retryLocalServer"),j=document.getElementById("customServerUrl"),W=document.getElementById("motherTongue"),z=document.getElementById("variant-en"),J=document.getElementById("variant-de"),K=document.getElementById("variant-pt"),Q=document.getElementById("variant-ca"),X=document.getElementById("autoCheckAllDomains"),Z=document.getElementById("autoCheckDomains-options"),ee=document.getElementById("autoCheckDomains"),te=document.getElementById("autoCheckDomainInput"),ne=document.getElementById("addToAutoCheckDomains"),oe=document.getElementById("autoCheckDomains-options__clearAll"),ae=document.getElementById("ignoredDomains-options"),se=document.getElementById("ignoredDomains"),ie=document.getElementById("ignoredDomainInput"),le=document.getElementById("addToIgnoredDomains"),de=document.getElementById("ignoredDomains-options__clearAll"),ce=document.getElementById("copyright-link"),re=document.getElementById("synonyms-toggle-wrapper"),ge=document.querySelectorAll("[data-lt-nice-select]"),ue=/^(https?:\/\/)?localhost(:[0-9]{1,5})?(\/.*)?$/i,me=/^(https?:\/\/)?[a-z0-9]+([-.]{1}[a-z0-9]+)*\.[a-z]{2,15}(:[0-9]{1,5})?(\/.*)?$/i,pe=/^(?:https?:\/\/)?(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}(?::[0-9]{1,5})?$/,ye=StorageController.create();function Ee(e){return ue.test(e)||me.test(e)||pe.test(e)}function he(){const{hasPaidSubscription:e}=ye.getUIState();document.body.classList.toggle("lt-options--plus",e),i.innerHTML="",new PackageBadge(null,e?"premium":"basic","default",i),function(){const{havePremiumAccount:e,username:t}=ye.getSettings(),n=document.getElementById("lt-login"),o=document.getElementById("lt-account");e?(n.style.display="none",o.style.display="block",G.style.display="block",V.setAttribute("disabled",""),translateElement("#account-text",{key:"settingsLoggedInAs",isHTML:!0,interpolations:[`<strong>${t}</strong>`]})):(n.style.display="block",o.style.display="none",G.style.display="none",V.removeAttribute("disabled"))}(),fe()}function fe(){const{apiServerUrl:o,disablePersonalDictionary:s,disableIgnoredRules:i,loginUrl:c}=ye.getManagedSettings(),{havePremiumAccount:r,username:g}=ye.getSettings();s&&(p.style.display="none",y.style.display="none"),i&&(k.style.display="none",L.style.display="none"),o&&(P.style.display="none",e.style.display="none"),c&&(e.style.display="none",t.style.display="none",n.style.display="none",a.style.display="none",l.style.display="",d.style.display="");const u=document.getElementById("managed-login-box"),m=document.getElementById("managed-logout-box");r?(u.style.display="none",m.style.display="block",translateElement("#managed-account-text",{key:"settingsLoggedInAs",isHTML:!0,interpolations:[`<strong>${g}</strong>`]})):(u.style.display="block",m.style.display="none")}function ve(e){if(!(e.target instanceof HTMLButtonElement))return;const t=e.target.closest("[data-preferred-language]");if(!t||"string"!=typeof t.dataset.preferredLanguage)return;const{preferredLanguages:n}=ye.getSettings(),o=n.indexOf(t.dataset.preferredLanguage);-1!==o&&(ye.updateSettings({preferredLanguages:n.slice(0,o).concat(n.slice(o+1))}),ke())}function be(e){if(!(e.target instanceof HTMLSelectElement))return;const{preferredLanguages:t}=ye.getSettings();ye.updateSettings({preferredLanguages:uniq(t.concat([e.target.value]))}),ke()}function ke(){const{preferredLanguages:e}=ye.getSettings(),t=Array.from(document.querySelectorAll("[data-preferred-language]")),n=Array.from(R.querySelectorAll("optgroup"));t.concat(n).forEach((e=>{e.remove()})),e.forEach((e=>{const t=LanguageManager.ALL_LANGUAGES.find((({code:t})=>t===e));if(!t)return;const n=Object.assign(document.createElement("span"),{textContent:t.name,className:"lt-pill-box__item__text"}),o=Object.assign(document.createElement("button"),{className:"lt-pill-box__item__delete lt-icon lt-icon__close_small",type:"button"}),a=Object.assign(document.createElement("div"),{className:"lt-pill-box__item lt-pill-box__item--option"});a.dataset.preferredLanguage=e,a.appendChild(n),a.appendChild(o),O.insertBefore(a,R.parentNode)}));const o=document.createElement("optgroup"),a=document.createElement("optgroup");LanguageManager.ALL_LANGUAGES.forEach((t=>{if(e.includes(t.code))return;const n=Object.assign(document.createElement("option"),{value:t.code,textContent:t.name});LanguageManager.POPULAR_LANGUAGES.includes(t.code)&&o.appendChild(n.cloneNode(!0)),a.appendChild(n)})),o.setAttribute("data-t-attr",JSON.stringify(["label","settingsPreferredLanguagesPopularList"])),a.setAttribute("data-t-attr",JSON.stringify(["label","settingsPreferredLanguagesCompleteList"])),R.appendChild(o),R.appendChild(a),x.textContent=e.length?`(${e.length})`:"",translateSection(R)}function Le(e,t){e.value=t,e.dispatchEvent(new Event("change",{bubbles:!0}))}function Se(){ye&&(u.classList.add("lt-toggle--checked"),ye.updateSettings({hasSynonymsEnabled:!0}))}function _e(){ye&&(u.classList.remove("lt-toggle--checked"),ye.updateSettings({hasSynonymsEnabled:!1}))}function Ie(){ye&&(m.classList.add("lt-toggle--checked"),ye.updateSettings({hasPickyModeEnabledGlobally:!0}))}function De(){ye&&(m.classList.remove("lt-toggle--checked"),ye.updateSettings({hasPickyModeEnabledGlobally:!1}))}function Ce(e=Dictionary.getSorted(),t=0===Dictionary.get().length){E.innerHTML="";for(const t of e){const e=document.createElement("li");e.className="lt-personal-dictionary__item";const n=document.createElement("span");n.className="lt-personal-dictionary__title",n.textContent=t,e.appendChild(n);const o=document.createElement("span");o.className="lt-personal-dictionary__delete-button",o.dataset.word=t,o.addEventListener("click",Ae),e.appendChild(o),E.appendChild(e)}const n=document.getElementById("personalDictionary-optionsInside"),o=document.getElementById("personalDictionary-options__emptyState"),a=document.getElementById("personalDictionary-options__emptySearch");e.length>0?(n.style.display="block",o.style.display="none",a.style.display="none"):t?(n.style.display="none",o.style.display="block",a.style.display="none"):(n.style.display="none",o.style.display="none",a.style.display="block")}function Be(){const e=h.value;f.disabled=""===e.trim();const t=Dictionary.getSorted(),n=[];for(const o of t)o.includes(e)&&n.push(o);Ce(n,0===t.length)}function Me(){const e=h.value.trim();e&&(Dictionary.add(e).then((()=>Ce())),h.value="",f.disabled=!0)}function Ae(e){const t=e.currentTarget.dataset.word;t&&Dictionary.remove(t).then(Be)}function Te(){S.innerHTML="";const e=ye.getSettings().ignoredRules,t=i18nManager.getMessage("enableRuleTooltip");for(const n of e){if(n.language){const e=LanguageManager.getUserLanguageCodes().some((e=>n.language.toLowerCase().startsWith(e)||"*"===n.language));if(StorageControllerClass.getDefaultSettings().ignoredRules.some((e=>e.id===n.id))&&!e)continue}const e=document.createElement("li");e.className="lt-options__rules__item";const o=document.createElement("span");o.className="lt-options__rules__title",o.textContent="- "+(n.description||n.id),e.appendChild(o);const a=document.createElement("span");a.className="lt-options__rules__enable-button",a.setAttribute("title",t),a.dataset.ruleId=n.id,a.textContent=t,a.addEventListener("click",we),e.appendChild(a),S.appendChild(e)}const n=document.getElementById("ignoredRules-optionsInside"),o=document.getElementById("ignoredRules-options__emptyState");e.length>0?(n.style.display="block",o.style.display="none"):(n.style.display="none",o.style.display="block")}function we(e){const t=e.currentTarget.dataset.ruleId;if(t){const e=ye.getSettings().ignoredRules.filter((e=>e.id!==t));ye.updateSettings({ignoredRules:e}).then(Te)}}function xe(e=ye.getSettings().disabledDomains,t=ye.getSettings().disabledDomains.length>0){C.innerHTML="";const n=i18nManager.getMessage("settingsEnableDomain");for(const t of e){const e=document.createElement("li");e.className="lt-options__rules__item";const o=document.createElement("span");o.className="lt-options__rules__title",o.textContent="● "+t,e.appendChild(o);const a=document.createElement("span");a.className="lt-options__rules__enable-button",a.setAttribute("title",n),a.dataset.domain=t,a.textContent=n,a.addEventListener("click",Ne),e.appendChild(a),C.appendChild(e)}const o=document.getElementById("disabledDomains-optionsInside"),a=document.getElementById("disabledDomains-options__emptyState"),s=document.getElementById("disabledDomains-options__emptySearch");e.length>0?(o.style.display="block",a.style.display="none",s.style.display="none"):t?(o.style.display="none",a.style.display="block",s.style.display="none"):(o.style.display="none",a.style.display="none",s.style.display="block")}function Oe(){const e=B.value;M.disabled=""===e.trim();const t=ye.getSettings().disabledDomains.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),n=[];for(const o of t)o.includes(e)&&n.push(o);xe(n,0===t.length)}function Re(){const e=B.value.trim(),t=getDomain(e,"");if(""===t.trim()||!Ee(e))return void alert(i18nManager.getMessage("settingsDomainInvalid"));B.value="",M.disabled=!0;const n=ye.getSettings().disabledDomains;n.includes(t)?xe(n,!1):(n.push(t),ye.updateSettings({disabledDomains:n}).then((()=>xe(n,!1))))}function Ne(e){const t=e.currentTarget.dataset.domain;if(t){const e=ye.getSettings().disabledDomains.filter((e=>e!==t));ye.updateSettings({disabledDomains:e}).then(Oe)}}function Ue(){Pe($.checked),q.checked?Ve():F.style.display="none"}function Pe(e=!1){j.style.display=e?"block":"none",j.required=e,e?j.value=j.dataset.prevValue||"":(j.dataset.prevValue=j.value,j.value="")}function Ve(){fetch(config.LOCAL_SERVER_URL+"/languages",{method:"GET",mode:"cors"}).then((()=>{F.style.display="none"})).catch((()=>{F.style.display="block"}))}function Ge(e=!1){Z.style.display=e?"none":"",ae.style.display=e?"":"none"}function He(e=ye.getSettings().autoCheckOnDomains,t=0===ye.getSettings().autoCheckOnDomains.length){ee.innerHTML="";const n=i18nManager.getMessage("settingsDeleteAutoCheckDomain");for(const t of e){const e=document.createElement("li");e.className="lt-options__rules__item";const o=document.createElement("span");o.className="lt-options__rules__title",o.textContent="● "+t,e.appendChild(o);const a=document.createElement("span");a.className="lt-options__rules__enable-button",a.setAttribute("title",n),a.dataset.domain=t,a.textContent=n,a.addEventListener("click",Fe),e.appendChild(a),ee.appendChild(e)}const o=document.getElementById("autoCheckDomains-optionsInside"),a=document.getElementById("autoCheckDomains-options__emptyState"),s=document.getElementById("autoCheckDomains-options__emptySearch");e.length>0?(o.style.display="block",a.style.display="none",s.style.display="none"):t?(o.style.display="none",a.style.display="block",s.style.display="none"):(o.style.display="none",a.style.display="none",s.style.display="block")}function qe(){const e=te.value;ne.disabled=""===e.trim();const t=ye.getSettings().autoCheckOnDomains.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),n=[];for(const o of t)o.includes(e)&&n.push(o);He(n,0===t.length)}function $e(){const e=te.value.trim(),t=getDomain(e,"");if(""===t.trim()||!Ee(e))return void alert(i18nManager.getMessage("settingsDomainInvalid"));te.value="",ne.disabled=!0;const n=ye.getSettings().autoCheckOnDomains;n.includes(t)?He(n,!1):(n.push(t),ye.updateSettings({autoCheckOnDomains:n}).then((()=>He(n,!1))))}function Fe(e){const t=e.currentTarget.dataset.domain;if(t){const e=ye.getSettings().autoCheckOnDomains.filter((e=>e!==t));ye.updateSettings({autoCheckOnDomains:e}).then((()=>He(e,0===e.length)))}}function Ye(e=ye.getSettings().ignoreCheckOnDomains,t=0===ye.getSettings().ignoreCheckOnDomains.length){se.innerHTML="";const n=i18nManager.getMessage("settingsDeleteIgnoredDomain");for(const t of e){const e=document.createElement("li");e.className="lt-options__rules__item";const o=document.createElement("span");o.className="lt-options__rules__title",o.textContent="● "+t,e.appendChild(o);const a=document.createElement("span");a.className="lt-options__rules__enable-button",a.setAttribute("title",n),a.dataset.domain=t,a.textContent=n,a.addEventListener("click",ze),e.appendChild(a),se.appendChild(e)}const o=document.getElementById("ignoredDomains-optionsInside"),a=document.getElementById("ignoredDomains-options__emptyState"),s=document.getElementById("ignoredDomains-options__emptySearch");e.length>0?(o.style.display="block",a.style.display="none",s.style.display="none"):t?(o.style.display="none",a.style.display="block",s.style.display="none"):(o.style.display="none",a.style.display="none",s.style.display="block")}function je(){const e=ie.value;le.disabled=""===e.trim();const t=ye.getSettings().ignoreCheckOnDomains.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),n=[];for(const o of t)o.includes(e)&&n.push(o);Ye(n,0===t.length)}function We(){const e=ie.value.trim(),t=getDomain(e);if(""===t.trim()||!Ee(e))return void alert(i18nManager.getMessage("settingsDomainInvalid"));ie.value="",le.disabled=!0;const n=ye.getSettings().ignoreCheckOnDomains;n.includes(t)?Ye(n,!1):(n.push(t),ye.updateSettings({ignoreCheckOnDomains:n}).then((()=>Ye(n,!1))))}function ze(e){const t=e.currentTarget.dataset.domain;if(t){const e=ye.getSettings().ignoreCheckOnDomains.filter((e=>e!==t));ye.updateSettings({ignoreCheckOnDomains:e}).then((()=>Ye(e,0===e.length)))}}translateSection(document.documentElement),document.documentElement.lang=navigator.language,BrowserDetector.isSafari()?document.getElementById("haveAccountDesc").style.display="none":document.getElementById("haveAccountDesc").innerHTML=i18nManager.getMessage("haveAccountDesc")+" <a target='_blank' href='https://languagetool.org'>LanguageTool.org</a>",document.getElementById("privacyPolicy").innerHTML="<a target='_blank' href='https://languagetool.org/privacy/'>"+i18nManager.getMessage("privacyPolicy")+"</a>",Array.from(document.querySelectorAll("[data-premium-link]")).forEach((e=>{e.addEventListener("click",(e=>{browser.runtime.sendMessage({command:"OPEN_PREMIUM_PAGE",campaign:"addon2-options"}),e.preventDefault()}))}));const Je=location.hash.replace(/\?.*$/,""),Ke=document.querySelector(Je||"#login");Ke&&Ke.nextElementSibling&&Ke.nextElementSibling.classList.contains("lt-toggle-box")&&(Ke.classList.add("lt-options-toggle--visible"),Ke.nextElementSibling.classList.add("lt-toggle-box--visible"),Je&&document.documentElement.scrollTo(0,Ke.offsetTop-75));let Qe;LanguageManager.getUserLanguageCodes().some((e=>e.startsWith("de")||e.startsWith("fr")||e.startsWith("nl")))&&(document.getElementById("made-in-potsdam").style.display="inline"),ye.onReady((function(){he(),Ce(),Te(),xe(),fe(),Array.from(ge).forEach((e=>{const t=e.querySelector("select");null==t||t.addEventListener("change",(()=>{const n=e.querySelector("span")||document.createElement("span"),o=Array.from(t.children).filter((e=>e instanceof HTMLOptionElement)).find((e=>e.value===t.value));n.parentNode&&n.parentNode.removeChild(n),n.textContent=(null==o?void 0:o.textContent)||"",e.insertBefore(n,t),e.dataset.ltNiceSelect=t.value}))})),O.addEventListener("click",ve),R.addEventListener("change",be),ke();const e=ye.getSettings();e.apiServerUrl===config.MAIN_SERVER_URL?(H.checked=!0,re.style.display=""):e.apiServerUrl===config.LOCAL_SERVER_URL?(q.checked=!0,re.style.display="none"):(Pe(!0),$.checked=!0,j.value=e.apiServerUrl,re.style.display="none"),Le(W,e.motherTongue),Le(z,e.enVariant),Le(J,e.deVariant),Le(K,e.ptVariant),Le(Q,e.caVariant),X.checked=e.autoCheck,Ge(e.autoCheck),e.hasSynonymsEnabled?Se():_e(),function(e){e?Ie():De()}(e.hasPickyModeEnabledGlobally),He(),Ye(),ye.addEventListener(StorageControllerClass.eventNames.uiStateChanged,(e=>{e.hasPaidSubscription&&e.hasPaidSubscription.newValue&&he()}))})),ye.onReady((()=>{ye.startChangelogCoupon();const e=ye.getActiveCoupon();e&&(window.clearInterval(Qe),Qe=window.setInterval((()=>{g.querySelector("#lt-options-dicount-percent").textContent=i18nManager.getMessage("upgradeTeaserDiscount",[e.percent]),g.querySelector("#lt-options-discount-expires").textContent=` – ${i18nManager.getMessage("changelogDiscountExpires")} ${getCountdown(e.expires||0)}`,g.classList.add("lt-options__discount--visible")}),1e3))})),Dictionary.init(ye),Tracker.trackPageView(),o.addEventListener("click",(e=>{e.preventDefault(),function(){const e=document.getElementById("login-success"),t=document.getElementById("login-error");ye.updateSettings({username:"",password:"",userId:null,token:"",isDictionarySynced:!1,havePremiumAccount:!1}).then((()=>{Tracker.trackEvent("Action","logout"),e.style.display="block",translateElement(e,"settingsLogoutSuccess")})).catch((()=>{t.style.display="block",translateElement(t,"settingsUnknownError")})).then((()=>{ye.checkForPaidSubscription().then(he),browser.runtime.sendMessage({command:"LOGOUT"})}))}()})),a.addEventListener("click",(e=>{e.preventDefault(),window.open("https://languagetool.org/editor/settings/account","_blank")})),c.addEventListener("click",(e=>{e.preventDefault(),function(){const{loginUrl:e}=ye.getManagedSettings();goToManagedLogin(e,((e,t)=>(ye.updatePrivacySettings({allowRemoteCheck:!0}),ye.updateSettings({username:e,password:"",token:t,knownEmail:e,havePremiumAccount:!0}).then((()=>(fe(),ye.checkForPaidSubscription()))).then((()=>{he(),browser.runtime.sendMessage({command:"START_DICTIONARY_SYNC"}),browser.runtime.sendMessage({command:"LOGIN"})})))))}()})),r.addEventListener("click",(e=>{e.preventDefault(),ye.updateSettings({username:"",password:"",userId:null,token:"",isDictionarySynced:!1,havePremiumAccount:!1}).then((()=>{fe(),ye.checkForPaidSubscription().then(he),browser.runtime.sendMessage({command:"LOGOUT"})}))})),s.addEventListener("click",(e=>{e.preventDefault(),function(){const e=config.CLIENT_LOGIN_URL,t=document.getElementById("login-error"),n=document.getElementById("login-success");goToLogin(e,((e,o)=>(ye.updatePrivacySettings({allowRemoteCheck:!0}),ye.updateSettings({username:e,password:"",token:o,knownEmail:e,havePremiumAccount:!0,apiServerUrl:config.MAIN_SERVER_URL}).then((()=>(Tracker.trackEvent("Action","login",e),n.style.display="block",translateElement(n,"settingsLoginSuccess"),fe(),ye.checkForPaidSubscription()))).then((()=>{he(),EnvironmentAdapter.startDictionarySync()})).catch((()=>{Tracker.trackEvent("Action","login_error",e),t.style.display="block",translateElement(t,"settingsLoginError")})).then((()=>{browser.runtime.sendMessage({command:"LOGIN"})})))))}()})),u.addEventListener("click",(()=>{u.classList.contains("lt-toggle--checked")?(_e(),Tracker.trackEvent("Action","disable_synonyms",LanguageManager.getUserLanguageCodes()[0])):(Se(),Tracker.trackEvent("Action","enable_synonyms",LanguageManager.getUserLanguageCodes()[0]))})),m.addEventListener("click",(()=>{m.classList.contains("lt-toggle--checked")?(De(),Tracker.trackEvent("Action","disable_picky_mode",LanguageManager.getUserLanguageCodes()[0])):(Ie(),Tracker.trackEvent("Action","enable_picky_mode",LanguageManager.getUserLanguageCodes()[0]))})),p.addEventListener("click",(()=>{y.classList.toggle("lt-toggle-box--visible"),p.classList.toggle("lt-options-toggle--visible")&&h.focus()})),h.addEventListener("keydown",(e=>{"Enter"===e.key&&Me()})),h.addEventListener("input",(()=>{setTimeout(Be,0)})),h.addEventListener("paste",(function(e){if(h.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);n.length<=1||(e.preventDefault(),Dictionary.addBatch(n).then((()=>Ce())))})),f.addEventListener("click",Me),v.addEventListener("click",(function(){confirm(i18nManager.getMessage("settingsAreYouSure"))&&Dictionary.clear().then((()=>Ce([],!0)))})),b.addEventListener("click",(function(){const e=Dictionary.getSorted(),t=document.createElement("textarea");t.value=e.join("\n"),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t);const n=document.getElementById("personalDictionary-options__copyMessage");n.style.display="block",wait(3e3).then((()=>fadeOut(n,(()=>{n.style.display="none",n.style.opacity="1"}))))})),k.addEventListener("click",(()=>{k.classList.toggle("lt-options-toggle--visible"),L.classList.toggle("lt-toggle-box--visible")})),_.addEventListener("click",(function(){ye.updateSettings({ignoredRules:[]}).then(Te)})),BrowserDetector.isThunderbird()?(I.hidden=!0,document.body.setAttribute("data-is-thunderbird","true")):I.addEventListener("click",(()=>{D.classList.toggle("lt-toggle-box--visible"),I.classList.toggle("lt-options-toggle--visible")&&B.focus()})),B.addEventListener("keydown",(e=>{"Enter"===e.key&&Re()})),B.addEventListener("input",(()=>{setTimeout(Oe,0)})),B.addEventListener("paste",(function(e){if(B.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);if(n.length<=1)return;e.preventDefault();const o=ye.getSettings().disabledDomains;n.forEach((e=>{const t=getDomain(e,"");t.trim()&&Ee(e)&&!o.includes(t)&&o.push(t)})),ye.updateSettings({disabledDomains:o}).then(Oe)})),M.addEventListener("click",Re),A.addEventListener("click",(function(){confirm(i18nManager.getMessage("settingsAreYouSure"))&&ye.updateSettings({disabledDomains:[]}).then((()=>xe([],!0)))})),T.addEventListener("click",(()=>{T.classList.toggle("lt-options-toggle--visible"),w.classList.toggle("lt-toggle-box--visible")})),N.addEventListener("click",(e=>{N.classList.toggle("lt-options-toggle--visible"),U.classList.toggle("lt-toggle-box--visible")})),H.addEventListener("click",Ue),q.addEventListener("click",Ue),$.addEventListener("click",Ue),Y.addEventListener("click",(e=>{e.preventDefault(),Ve()})),P.addEventListener("submit",(e=>{e.preventDefault(),function(){let e="";e=H.checked?config.MAIN_SERVER_URL:q.checked?config.LOCAL_SERVER_URL:j.value.trim();const t=document.getElementById("serverUrl-success"),n=document.getElementById("serverUrl-error");ye.updateSettings({apiServerUrl:e}).then((()=>{ye.checkForPaidSubscription().then((()=>{he()})),t.style.display="block",wait(3e3).then((()=>fadeOut(t,(()=>{t.style.display="none",t.style.opacity="1"}))))})).catch((()=>{n.style.display="block",wait(3e3).then((()=>fadeOut(n,(()=>{n.style.display="none",n.style.opacity="1"}))))}))}()})),W.addEventListener("change",(function(){ye.updateSettings({motherTongue:W.value})})),z.addEventListener("change",(function(){ye.updateSettings({enVariant:z.value})})),J.addEventListener("change",(function(){ye.updateSettings({deVariant:J.value})})),K.addEventListener("change",(function(){ye.updateSettings({ptVariant:K.value})})),Q.addEventListener("change",(function(){ye.updateSettings({caVariant:Q.value})})),X.addEventListener("input",(()=>{ye.updateSettings({autoCheck:X.checked}),Ge(X.checked)})),te.addEventListener("keydown",(e=>{"Enter"===e.key&&$e()})),te.addEventListener("input",(()=>{setTimeout(qe,0)})),te.addEventListener("paste",(function(e){if(te.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);if(n.length<=1)return;e.preventDefault();const o=ye.getSettings().autoCheckOnDomains;n.forEach((e=>{const t=getDomain(e,"");t.trim()&&Ee(e)&&!o.includes(t)&&o.push(t)})),ye.updateSettings({autoCheckOnDomains:o}).then(qe)})),ne.addEventListener("click",$e),oe.addEventListener("click",(function(){confirm(i18nManager.getMessage("settingsAreYouSure"))&&ye.updateSettings({autoCheckOnDomains:[]}).then((()=>He([],!0)))})),ie.addEventListener("keydown",(e=>{"Enter"===e.key&&We()})),ie.addEventListener("input",(()=>{setTimeout(je,0)})),ie.addEventListener("paste",(function(e){if(ie.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);if(n.length<=1)return;e.preventDefault();const o=ye.getSettings().ignoreCheckOnDomains;n.forEach((e=>{const t=getDomain(e);t.trim()&&Ee(e)&&!o.includes(t)&&o.push(t)})),ye.updateSettings({ignoreCheckOnDomains:o}).then(je)})),le.addEventListener("click",We),de.addEventListener("click",(function(){confirm(i18nManager.getMessage("settingsAreYouSure"))&&ye.updateSettings({ignoreCheckOnDomains:[]}).then((()=>Ye([],!0)))})),BrowserDetector.isSafari()&&ce instanceof HTMLAnchorElement&&(ce.href+=ce.href.includes("?")?"&hidePremium=true":"?hidePremium=true"),ye.onReady((()=>{const e=document.querySelector("#heart");if(e){const{showRuleId:t}=ye.getUIState();let n=0;e.style.cursor="default",e.style.userSelect="none",t&&(e.style.color="blue"),e.addEventListener("click",(o=>{4==++n&&(t?(e.style.color="",ye.updateUIState({showRuleId:!1})):(e.style.color="blue",ye.updateUIState({showRuleId:!0}))),o.preventDefault()}))}}))}();