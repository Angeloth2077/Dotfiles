/*! (C) Copyright 2020 LanguageTooler GmbH. All rights reserved. */
!function(){const e=document.getElementById("banner"),t=document.getElementById("login"),n=document.getElementById("login-options"),o=document.getElementById("logout-button"),a=document.getElementById("manage-account-button"),s=document.getElementById("login-popup-button"),i=document.getElementById("lt-options__package-badge-container"),l=document.getElementById("managed-login"),d=document.getElementById("managed-login-options"),c=document.getElementById("managed-login-button"),r=document.getElementById("managed-logout-button"),g=document.getElementById("lt-options-discount"),u=document.getElementById("toggleSynonymsSwitch"),m=document.getElementById("togglePickyModeSwitch"),p=document.getElementById("personalDictionary"),y=document.getElementById("personalDictionary-options"),E=document.getElementById("personalDictionaryList"),h=document.getElementById("personalDictionaryInput"),f=document.getElementById("addToPersonalDictionary"),v=document.getElementById("personalDictionary-options__clearAll"),b=document.getElementById("personalDictionary-options__copy"),k=document.getElementById("ignoredRules"),L=document.getElementById("ignoredRules-options"),S=document.getElementById("ignoredRulesList"),_=document.getElementById("ignoredRules-options__clearAll"),I=document.getElementById("disabledDomains"),D=document.getElementById("disabledDomains-options"),C=document.getElementById("disabledDomainsList"),B=document.getElementById("disabledDomainsInput"),M=document.getElementById("addToDisabledDomains"),A=document.getElementById("disabledDomains-options__clearAll"),T=document.getElementById("language"),w=document.getElementById("language-options"),x=document.getElementById("preferred-languages-count"),O=document.getElementById("preferred-languages"),R=document.getElementById("new-preferred-languages"),N=document.getElementById("experimental"),U=document.getElementById("experimental-options"),P=document.getElementById("serverUrl"),V=document.getElementById("serverType-cloud"),G=document.getElementById("serverType-local"),H=document.getElementById("serverType-custom"),q=document.getElementById("localServerAvailabilityWarning"),$=document.getElementById("retryLocalServer"),Y=document.getElementById("customServerUrl"),j=document.getElementById("motherTongue"),F=document.getElementById("variant-en"),W=document.getElementById("variant-de"),z=document.getElementById("variant-pt"),J=document.getElementById("variant-ca"),K=document.getElementById("autoCheckAllDomains"),Q=document.getElementById("autoCheckDomains-options"),X=document.getElementById("autoCheckDomains"),Z=document.getElementById("autoCheckDomainInput"),ee=document.getElementById("addToAutoCheckDomains"),te=document.getElementById("autoCheckDomains-options__clearAll"),ne=document.getElementById("ignoredDomains-options"),oe=document.getElementById("ignoredDomains"),ae=document.getElementById("ignoredDomainInput"),se=document.getElementById("addToIgnoredDomains"),ie=document.getElementById("ignoredDomains-options__clearAll"),le=document.getElementById("copyright-link"),de=document.getElementById("synonyms-toggle-wrapper"),ce=document.querySelectorAll("[data-lt-nice-select]"),re=/^(https?:\/\/)?localhost(:[0-9]{1,5})?(\/.*)?$/i,ge=/^(https?:\/\/)?[a-z0-9]+([-.]{1}[a-z0-9]+)*\.[a-z]{2,15}(:[0-9]{1,5})?(\/.*)?$/i,ue=/^(?:https?:\/\/)?(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])(?:\.(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])){3}(?::[0-9]{1,5})?$/,me=StorageController.create();function pe(e){return re.test(e)||ge.test(e)||ue.test(e)}function ye(){const{hasPaidSubscription:e}=me.getUIState();document.body.classList.toggle("lt-options--plus",e),i.innerHTML="",new PackageBadge(null,e?"premium":"basic","default",i),function(){const{havePremiumAccount:e,username:t}=me.getSettings(),n=document.getElementById("lt-login"),o=document.getElementById("lt-account");e?(n.style.display="none",o.style.display="block",P.style.display="none",translateElement("#account-text",{key:"settingsLoggedInAs",isHTML:!0,interpolations:[`<strong>${t}</strong>`]})):(n.style.display="block",o.style.display="none",P.style.display="block")}(),Ee()}function Ee(){const{apiServerUrl:o,disablePersonalDictionary:s,disableIgnoredRules:i,loginUrl:c}=me.getManagedSettings(),{havePremiumAccount:r,username:g}=me.getSettings();s&&(p.style.display="none",y.style.display="none"),i&&(k.style.display="none",L.style.display="none"),o&&(P.style.display="none",e.style.display="none"),c&&(e.style.display="none",t.style.display="none",n.style.display="none",a.style.display="none",l.style.display="",d.style.display="");const u=document.getElementById("managed-login-box"),m=document.getElementById("managed-logout-box");r?(u.style.display="none",m.style.display="block",translateElement("#managed-account-text",{key:"settingsLoggedInAs",isHTML:!0,interpolations:[`<strong>${g}</strong>`]})):(u.style.display="block",m.style.display="none")}function he(e){if(!(e.target instanceof HTMLButtonElement))return;const t=e.target.closest("[data-preferred-language]");if(!t||"string"!=typeof t.dataset.preferredLanguage)return;const{preferredLanguages:n}=me.getSettings(),o=n.indexOf(t.dataset.preferredLanguage);-1!==o&&(me.updateSettings({preferredLanguages:n.slice(0,o).concat(n.slice(o+1))}),ve())}function fe(e){if(!(e.target instanceof HTMLSelectElement))return;const{preferredLanguages:t}=me.getSettings();me.updateSettings({preferredLanguages:uniq(t.concat([e.target.value]))}),ve()}function ve(){const{preferredLanguages:e}=me.getSettings(),t=Array.from(document.querySelectorAll("[data-preferred-language]")),n=Array.from(R.querySelectorAll("optgroup"));t.concat(n).forEach((e=>{e.remove()})),e.forEach((e=>{const t=LanguageManager.ALL_LANGUAGES.find((({code:t})=>t===e));if(!t)return;const n=Object.assign(document.createElement("span"),{textContent:t.name,className:"lt-pill-box__item__text"}),o=Object.assign(document.createElement("button"),{className:"lt-pill-box__item__delete lt-icon lt-icon__close_small",type:"button"}),a=Object.assign(document.createElement("div"),{className:"lt-pill-box__item lt-pill-box__item--option"});a.dataset.preferredLanguage=e,a.appendChild(n),a.appendChild(o),O.insertBefore(a,R.parentNode)}));const o=document.createElement("optgroup"),a=document.createElement("optgroup");LanguageManager.ALL_LANGUAGES.forEach((t=>{if(e.includes(t.code))return;const n=Object.assign(document.createElement("option"),{value:t.code,textContent:t.name});LanguageManager.POPULAR_LANGUAGES.includes(t.code)&&o.appendChild(n.cloneNode(!0)),a.appendChild(n)})),o.setAttribute("data-t-attr",JSON.stringify(["label","settingsPreferredLanguagesPopularList"])),a.setAttribute("data-t-attr",JSON.stringify(["label","settingsPreferredLanguagesCompleteList"])),R.appendChild(o),R.appendChild(a),x.textContent=e.length?`(${e.length})`:"",translateSection(R)}function be(e,t){e.value=t,e.dispatchEvent(new Event("change",{bubbles:!0}))}function ke(){me&&(u.classList.add("lt-toggle--checked"),me.updateSettings({hasSynonymsEnabled:!0}))}function Le(){me&&(u.classList.remove("lt-toggle--checked"),me.updateSettings({hasSynonymsEnabled:!1}))}function Se(){me&&(m.classList.add("lt-toggle--checked"),me.updateSettings({hasPickyModeEnabledGlobally:!0}))}function _e(){me&&(m.classList.remove("lt-toggle--checked"),me.updateSettings({hasPickyModeEnabledGlobally:!1}))}function Ie(e=Dictionary.getSorted(),t=0===Dictionary.get().length){E.innerHTML="";for(const t of e){const e=document.createElement("li");e.className="lt-personal-dictionary__item";const n=document.createElement("span");n.className="lt-personal-dictionary__title",n.textContent=t,e.appendChild(n);const o=document.createElement("span");o.className="lt-personal-dictionary__delete-button",o.dataset.word=t,o.addEventListener("click",Be),e.appendChild(o),E.appendChild(e)}const n=document.getElementById("personalDictionary-optionsInside"),o=document.getElementById("personalDictionary-options__emptyState"),a=document.getElementById("personalDictionary-options__emptySearch");e.length>0?(n.style.display="block",o.style.display="none",a.style.display="none"):t?(n.style.display="none",o.style.display="block",a.style.display="none"):(n.style.display="none",o.style.display="none",a.style.display="block")}function De(){const e=h.value;f.disabled=""===e.trim();const t=Dictionary.getSorted(),n=[];for(const o of t)o.includes(e)&&n.push(o);Ie(n,0===t.length)}function Ce(){const e=h.value.trim();e&&(Dictionary.add(e).then((()=>Ie())),h.value="",f.disabled=!0)}function Be(e){const t=e.currentTarget.dataset.word;t&&Dictionary.remove(t).then(De)}function Me(){S.innerHTML="";const e=me.getSettings().ignoredRules,t=i18nManager.getMessage("enableRuleTooltip");for(const n of e){if(n.language){const e=LanguageManager.getUserLanguageCodes().some((e=>n.language.toLowerCase().startsWith(e)||"*"===n.language));if(StorageControllerClass.getDefaultSettings().ignoredRules.some((e=>e.id===n.id))&&!e)continue}const e=document.createElement("li");e.className="lt-options__rules__item";const o=document.createElement("span");o.className="lt-options__rules__title",o.textContent="- "+(n.description||n.id),e.appendChild(o);const a=document.createElement("span");a.className="lt-options__rules__enable-button",a.setAttribute("title",t),a.dataset.ruleId=n.id,a.textContent=t,a.addEventListener("click",Ae),e.appendChild(a),S.appendChild(e)}const n=document.getElementById("ignoredRules-optionsInside"),o=document.getElementById("ignoredRules-options__emptyState");e.length>0?(n.style.display="block",o.style.display="none"):(n.style.display="none",o.style.display="block")}function Ae(e){const t=e.currentTarget.dataset.ruleId;if(t){const e=me.getSettings().ignoredRules.filter((e=>e.id!==t));me.updateSettings({ignoredRules:e}).then(Me)}}function Te(e=me.getSettings().disabledDomains,t=me.getSettings().disabledDomains.length>0){C.innerHTML="";const n=i18nManager.getMessage("settingsEnableDomain");for(const t of e){const e=document.createElement("li");e.className="lt-options__rules__item";const o=document.createElement("span");o.className="lt-options__rules__title",o.textContent="● "+t,e.appendChild(o);const a=document.createElement("span");a.className="lt-options__rules__enable-button",a.setAttribute("title",n),a.dataset.domain=t,a.textContent=n,a.addEventListener("click",Oe),e.appendChild(a),C.appendChild(e)}const o=document.getElementById("disabledDomains-optionsInside"),a=document.getElementById("disabledDomains-options__emptyState"),s=document.getElementById("disabledDomains-options__emptySearch");e.length>0?(o.style.display="block",a.style.display="none",s.style.display="none"):t?(o.style.display="none",a.style.display="block",s.style.display="none"):(o.style.display="none",a.style.display="none",s.style.display="block")}function we(){const e=B.value;M.disabled=""===e.trim();const t=me.getSettings().disabledDomains.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),n=[];for(const o of t)o.includes(e)&&n.push(o);Te(n,0===t.length)}function xe(){const e=B.value.trim(),t=getDomain(e,"");if(""===t.trim()||!pe(e))return void alert(i18nManager.getMessage("settingsDomainInvalid"));B.value="",M.disabled=!0;const n=me.getSettings().disabledDomains;n.includes(t)?Te(n,!1):(n.push(t),me.updateSettings({disabledDomains:n}).then((()=>Te(n,!1))))}function Oe(e){const t=e.currentTarget.dataset.domain;if(t){const e=me.getSettings().disabledDomains.filter((e=>e!==t));me.updateSettings({disabledDomains:e}).then(we)}}function Re(){Ne(H.checked),G.checked?Ue():q.style.display="none"}function Ne(e=!1){Y.style.display=e?"block":"none",Y.required=e,e?Y.value=Y.dataset.prevValue||"":(Y.dataset.prevValue=Y.value,Y.value="")}function Ue(){fetch(config.LOCAL_SERVER_URL+"/languages",{method:"GET",mode:"cors"}).then((()=>{q.style.display="none"})).catch((()=>{q.style.display="block"}))}function Pe(e=!1){Q.style.display=e?"none":"",ne.style.display=e?"":"none"}function Ve(e=me.getSettings().autoCheckOnDomains,t=0===me.getSettings().autoCheckOnDomains.length){X.innerHTML="";const n=i18nManager.getMessage("settingsDeleteAutoCheckDomain");for(const t of e){const e=document.createElement("li");e.className="lt-options__rules__item";const o=document.createElement("span");o.className="lt-options__rules__title",o.textContent="● "+t,e.appendChild(o);const a=document.createElement("span");a.className="lt-options__rules__enable-button",a.setAttribute("title",n),a.dataset.domain=t,a.textContent=n,a.addEventListener("click",qe),e.appendChild(a),X.appendChild(e)}const o=document.getElementById("autoCheckDomains-optionsInside"),a=document.getElementById("autoCheckDomains-options__emptyState"),s=document.getElementById("autoCheckDomains-options__emptySearch");e.length>0?(o.style.display="block",a.style.display="none",s.style.display="none"):t?(o.style.display="none",a.style.display="block",s.style.display="none"):(o.style.display="none",a.style.display="none",s.style.display="block")}function Ge(){const e=Z.value;ee.disabled=""===e.trim();const t=me.getSettings().autoCheckOnDomains.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),n=[];for(const o of t)o.includes(e)&&n.push(o);Ve(n,0===t.length)}function He(){const e=Z.value.trim(),t=getDomain(e,"");if(""===t.trim()||!pe(e))return void alert(i18nManager.getMessage("settingsDomainInvalid"));Z.value="",ee.disabled=!0;const n=me.getSettings().autoCheckOnDomains;n.includes(t)?Ve(n,!1):(n.push(t),me.updateSettings({autoCheckOnDomains:n}).then((()=>Ve(n,!1))))}function qe(e){const t=e.currentTarget.dataset.domain;if(t){const e=me.getSettings().autoCheckOnDomains.filter((e=>e!==t));me.updateSettings({autoCheckOnDomains:e}).then((()=>Ve(e,0===e.length)))}}function $e(e=me.getSettings().ignoreCheckOnDomains,t=0===me.getSettings().ignoreCheckOnDomains.length){oe.innerHTML="";const n=i18nManager.getMessage("settingsDeleteIgnoredDomain");for(const t of e){const e=document.createElement("li");e.className="lt-options__rules__item";const o=document.createElement("span");o.className="lt-options__rules__title",o.textContent="● "+t,e.appendChild(o);const a=document.createElement("span");a.className="lt-options__rules__enable-button",a.setAttribute("title",n),a.dataset.domain=t,a.textContent=n,a.addEventListener("click",Fe),e.appendChild(a),oe.appendChild(e)}const o=document.getElementById("ignoredDomains-optionsInside"),a=document.getElementById("ignoredDomains-options__emptyState"),s=document.getElementById("ignoredDomains-options__emptySearch");e.length>0?(o.style.display="block",a.style.display="none",s.style.display="none"):t?(o.style.display="none",a.style.display="block",s.style.display="none"):(o.style.display="none",a.style.display="none",s.style.display="block")}function Ye(){const e=ae.value;se.disabled=""===e.trim();const t=me.getSettings().ignoreCheckOnDomains.sort(((e,t)=>e.toLowerCase().localeCompare(t.toLowerCase()))),n=[];for(const o of t)o.includes(e)&&n.push(o);$e(n,0===t.length)}function je(){const e=ae.value.trim(),t=getDomain(e);if(""===t.trim()||!pe(e))return void alert(i18nManager.getMessage("settingsDomainInvalid"));ae.value="",se.disabled=!0;const n=me.getSettings().ignoreCheckOnDomains;n.includes(t)?$e(n,!1):(n.push(t),me.updateSettings({ignoreCheckOnDomains:n}).then((()=>$e(n,!1))))}function Fe(e){const t=e.currentTarget.dataset.domain;if(t){const e=me.getSettings().ignoreCheckOnDomains.filter((e=>e!==t));me.updateSettings({ignoreCheckOnDomains:e}).then((()=>$e(e,0===e.length)))}}translateSection(document.documentElement),document.documentElement.lang=navigator.language,BrowserDetector.isSafari()?document.getElementById("haveAccountDesc").style.display="none":document.getElementById("haveAccountDesc").innerHTML=i18nManager.getMessage("haveAccountDesc")+" <a target='_blank' href='https://languagetool.org'>LanguageTool.org</a>",document.getElementById("privacyPolicy").innerHTML="<a target='_blank' href='https://languagetool.org/privacy/'>"+i18nManager.getMessage("privacyPolicy")+"</a>",Array.from(document.querySelectorAll("[data-premium-link]")).forEach((e=>{e.addEventListener("click",(e=>{browser.runtime.sendMessage({command:"OPEN_PREMIUM_PAGE",campaign:"addon2-options"}),e.preventDefault()}))}));const We=location.hash.replace(/\?.*$/,""),ze=document.querySelector(We||"#login");ze&&ze.nextElementSibling&&ze.nextElementSibling.classList.contains("lt-toggle-box")&&(ze.classList.add("lt-options-toggle--visible"),ze.nextElementSibling.classList.add("lt-toggle-box--visible"),We&&document.documentElement.scrollTo(0,ze.offsetTop-75));let Je;LanguageManager.getUserLanguageCodes().some((e=>e.startsWith("de")||e.startsWith("fr")||e.startsWith("nl")))&&(document.getElementById("made-in-potsdam").style.display="inline"),me.onReady((function(){ye(),Ie(),Me(),Te(),Ee(),Array.from(ce).forEach((e=>{const t=e.querySelector("select");null==t||t.addEventListener("change",(()=>{const n=e.querySelector("span")||document.createElement("span"),o=Array.from(t.children).filter((e=>e instanceof HTMLOptionElement)).find((e=>e.value===t.value));n.parentNode&&n.parentNode.removeChild(n),n.textContent=(null==o?void 0:o.textContent)||"",e.insertBefore(n,t),e.dataset.ltNiceSelect=t.value}))})),O.addEventListener("click",he),R.addEventListener("change",fe),ve();const e=me.getSettings();e.apiServerUrl===config.MAIN_SERVER_URL?(V.checked=!0,de.style.display=""):e.apiServerUrl===config.LOCAL_SERVER_URL?(G.checked=!0,de.style.display="none"):(Ne(!0),H.checked=!0,Y.value=e.apiServerUrl,de.style.display="none"),be(j,e.motherTongue),be(F,e.enVariant),be(W,e.deVariant),be(z,e.ptVariant),be(J,e.caVariant),K.checked=e.autoCheck,Pe(e.autoCheck),e.hasSynonymsEnabled?ke():Le(),function(e){e?Se():_e()}(e.hasPickyModeEnabledGlobally),Ve(),$e(),me.addEventListener(StorageControllerClass.eventNames.uiStateChanged,(e=>{e.hasPaidSubscription&&e.hasPaidSubscription.newValue&&ye()}))})),me.onReady((()=>{me.startChangelogCoupon();const e=me.getActiveCoupon();e&&(window.clearInterval(Je),Je=window.setInterval((()=>{g.querySelector("#lt-options-dicount-percent").textContent=i18nManager.getMessage("upgradeTeaserDiscount",[e.percent]),g.querySelector("#lt-options-discount-expires").textContent=` – ${i18nManager.getMessage("changelogDiscountExpires")} ${getCountdown(e.expires||0)}`,g.classList.add("lt-options__discount--visible")}),1e3))})),Dictionary.init(me),Tracker.trackPageView(),o.addEventListener("click",(e=>{e.preventDefault(),function(){const e=document.getElementById("login-success"),t=document.getElementById("login-error");me.updateSettings({username:"",password:"",userId:null,token:"",isDictionarySynced:!1,havePremiumAccount:!1}).then((()=>{Tracker.trackEvent("Action","logout"),e.style.display="block",translateElement(e,"settingsLogoutSuccess")})).catch((()=>{t.style.display="block",translateElement(t,"settingsUnknownError")})).then((()=>{me.checkForPaidSubscription().then(ye),browser.runtime.sendMessage({command:"LOGOUT"})}))}()})),a.addEventListener("click",(e=>{e.preventDefault(),window.open("https://languagetool.org/editor/settings/account","_blank")})),c.addEventListener("click",(e=>{e.preventDefault(),function(){const{loginUrl:e}=me.getManagedSettings();goToManagedLogin(e,((e,t)=>(me.updatePrivacySettings({allowRemoteCheck:!0}),me.updateSettings({username:e,password:"",token:t,knownEmail:e,havePremiumAccount:!0}).then((()=>(Ee(),me.checkForPaidSubscription()))).then((()=>{ye(),browser.runtime.sendMessage({command:"START_DICTIONARY_SYNC"}),browser.runtime.sendMessage({command:"LOGIN"})})))))}()})),r.addEventListener("click",(e=>{e.preventDefault(),me.updateSettings({username:"",password:"",userId:null,token:"",isDictionarySynced:!1,havePremiumAccount:!1}).then((()=>{Ee(),me.checkForPaidSubscription().then(ye),browser.runtime.sendMessage({command:"LOGOUT"})}))})),s.addEventListener("click",(e=>{e.preventDefault(),function(){const e=config.CLIENT_LOGIN_URL,t=document.getElementById("login-error"),n=document.getElementById("login-success");goToLogin(e,((e,o)=>(me.updatePrivacySettings({allowRemoteCheck:!0}),me.updateSettings({username:e,password:"",token:o,knownEmail:e,havePremiumAccount:!0,apiServerUrl:config.MAIN_SERVER_URL}).then((()=>(Tracker.trackEvent("Action","login",e),n.style.display="block",translateElement(n,"settingsLoginSuccess"),Ee(),me.checkForPaidSubscription()))).then((()=>{ye(),EnvironmentAdapter.startDictionarySync()})).catch((()=>{Tracker.trackEvent("Action","login_error",e),t.style.display="block",translateElement(t,"settingsLoginError")})).then((()=>{browser.runtime.sendMessage({command:"LOGIN"})})))))}()})),u.addEventListener("click",(()=>{u.classList.contains("lt-toggle--checked")?(Le(),Tracker.trackEvent("Action","disable_synonyms",LanguageManager.getUserLanguageCodes()[0])):(ke(),Tracker.trackEvent("Action","enable_synonyms",LanguageManager.getUserLanguageCodes()[0]))})),m.addEventListener("click",(()=>{m.classList.contains("lt-toggle--checked")?(_e(),Tracker.trackEvent("Action","disable_picky_mode",LanguageManager.getUserLanguageCodes()[0])):(Se(),Tracker.trackEvent("Action","enable_picky_mode",LanguageManager.getUserLanguageCodes()[0]))})),p.addEventListener("click",(()=>{y.classList.toggle("lt-toggle-box--visible"),p.classList.toggle("lt-options-toggle--visible")&&h.focus()})),h.addEventListener("keydown",(e=>{"Enter"===e.key&&Ce()})),h.addEventListener("input",(()=>{setTimeout(De,0)})),h.addEventListener("paste",(function(e){if(h.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);n.length<=1||(e.preventDefault(),Dictionary.addBatch(n).then((()=>Ie())))})),f.addEventListener("click",Ce),v.addEventListener("click",(function(){confirm(i18nManager.getMessage("settingsAreYouSure"))&&Dictionary.clear().then((()=>Ie([],!0)))})),b.addEventListener("click",(function(){const e=Dictionary.getSorted(),t=document.createElement("textarea");t.value=e.join("\n"),document.body.appendChild(t),t.select(),document.execCommand("copy"),document.body.removeChild(t);const n=document.getElementById("personalDictionary-options__copyMessage");n.style.display="block",wait(3e3).then((()=>fadeOut(n,(()=>{n.style.display="none",n.style.opacity="1"}))))})),k.addEventListener("click",(()=>{k.classList.toggle("lt-options-toggle--visible"),L.classList.toggle("lt-toggle-box--visible")})),_.addEventListener("click",(function(){me.updateSettings({ignoredRules:[]}).then(Me)})),BrowserDetector.isThunderbird()?(I.hidden=!0,document.body.setAttribute("data-is-thunderbird","true")):I.addEventListener("click",(()=>{D.classList.toggle("lt-toggle-box--visible"),I.classList.toggle("lt-options-toggle--visible")&&B.focus()})),B.addEventListener("keydown",(e=>{"Enter"===e.key&&xe()})),B.addEventListener("input",(()=>{setTimeout(we,0)})),B.addEventListener("paste",(function(e){if(B.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);if(n.length<=1)return;e.preventDefault();const o=me.getSettings().disabledDomains;n.forEach((e=>{const t=getDomain(e,"");t.trim()&&pe(e)&&!o.includes(t)&&o.push(t)})),me.updateSettings({disabledDomains:o}).then(we)})),M.addEventListener("click",xe),A.addEventListener("click",(function(){confirm(i18nManager.getMessage("settingsAreYouSure"))&&me.updateSettings({disabledDomains:[]}).then((()=>Te([],!0)))})),T.addEventListener("click",(()=>{T.classList.toggle("lt-options-toggle--visible"),w.classList.toggle("lt-toggle-box--visible")})),N.addEventListener("click",(e=>{N.classList.toggle("lt-options-toggle--visible"),U.classList.toggle("lt-toggle-box--visible")})),V.addEventListener("click",Re),G.addEventListener("click",Re),H.addEventListener("click",Re),$.addEventListener("click",(e=>{e.preventDefault(),Ue()})),P.addEventListener("submit",(e=>{e.preventDefault(),function(){let e="";e=V.checked?config.MAIN_SERVER_URL:G.checked?config.LOCAL_SERVER_URL:Y.value.trim();const t=document.getElementById("serverUrl-success"),n=document.getElementById("serverUrl-error");me.updateSettings({apiServerUrl:e}).then((()=>{me.checkForPaidSubscription().then((()=>{ye()})),t.style.display="block",wait(3e3).then((()=>fadeOut(t,(()=>{t.style.display="none",t.style.opacity="1"}))))})).catch((()=>{n.style.display="block",wait(3e3).then((()=>fadeOut(n,(()=>{n.style.display="none",n.style.opacity="1"}))))}))}()})),j.addEventListener("change",(function(){me.updateSettings({motherTongue:j.value})})),F.addEventListener("change",(function(){me.updateSettings({enVariant:F.value})})),W.addEventListener("change",(function(){me.updateSettings({deVariant:W.value})})),z.addEventListener("change",(function(){me.updateSettings({ptVariant:z.value})})),J.addEventListener("change",(function(){me.updateSettings({caVariant:J.value})})),K.addEventListener("input",(()=>{me.updateSettings({autoCheck:K.checked}),Pe(K.checked)})),Z.addEventListener("keydown",(e=>{"Enter"===e.key&&He()})),Z.addEventListener("input",(()=>{setTimeout(Ge,0)})),Z.addEventListener("paste",(function(e){if(Z.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);if(n.length<=1)return;e.preventDefault();const o=me.getSettings().autoCheckOnDomains;n.forEach((e=>{const t=getDomain(e,"");t.trim()&&pe(e)&&!o.includes(t)&&o.push(t)})),me.updateSettings({autoCheckOnDomains:o}).then(Ge)})),ee.addEventListener("click",He),te.addEventListener("click",(function(){confirm(i18nManager.getMessage("settingsAreYouSure"))&&me.updateSettings({autoCheckOnDomains:[]}).then((()=>Ve([],!0)))})),ae.addEventListener("keydown",(e=>{"Enter"===e.key&&je()})),ae.addEventListener("input",(()=>{setTimeout(Ye,0)})),ae.addEventListener("paste",(function(e){if(ae.value)return;if(!e.clipboardData)return;const t=e.clipboardData.getData("text/plain");if(!t)return;const n=t.split(/\s+/);if(n.length<=1)return;e.preventDefault();const o=me.getSettings().ignoreCheckOnDomains;n.forEach((e=>{const t=getDomain(e);t.trim()&&pe(e)&&!o.includes(t)&&o.push(t)})),me.updateSettings({ignoreCheckOnDomains:o}).then(Ye)})),se.addEventListener("click",je),ie.addEventListener("click",(function(){confirm(i18nManager.getMessage("settingsAreYouSure"))&&me.updateSettings({ignoreCheckOnDomains:[]}).then((()=>$e([],!0)))})),BrowserDetector.isSafari()&&le instanceof HTMLAnchorElement&&(le.href+=le.href.includes("?")?"&hidePremium=true":"?hidePremium=true"),me.onReady((()=>{const e=document.querySelector("#heart");if(e){const{showRuleId:t}=me.getUIState();let n=0;e.style.cursor="default",e.style.userSelect="none",t&&(e.style.color="blue"),e.addEventListener("click",(o=>{4==++n&&(t?(e.style.color="",me.updateUIState({showRuleId:!1})):(e.style.color="blue",me.updateUIState({showRuleId:!0}))),o.preventDefault()}))}}))}();